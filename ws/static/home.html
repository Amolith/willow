<!DOCTYPE html>
<html lang="en-GB">
    <head>
        <title>Willow</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="title" content="Willow">
        <meta name="description" content="Forge-agnostic software release tracker">

        <!-- Indicate that we support both light and dark mode -->
        <meta name="color-scheme" content="dark light">

        <!-- Preload CSS reset -->
        <link rel="preload" href="/static/reset.css" as="style" />
        <link rel="stylesheet" href="/static/reset.css" />

        <!-- Preload CSS styles -->
        <link rel="preload" href="/static/styles.css" as="style" />
        <link rel="stylesheet" href="/static/styles.css" />
    </head>
    <body>
        <h1>Willow &nbsp;&nbsp;&nbsp;<span><a href="/logout">Log out</a></span></h1>
        <p><a href="/new">Track a new project</a></p>
        <div class="projects">
        <!-- Range through projects that aren't yet up-to-date -->
        {{- range . -}}
        {{- if ne .Running (index .Releases 0).Tag -}}
        <div class="project">
            <h2><a href="{{ .URL }}">{{ .Name }}</a>&nbsp;&nbsp;&nbsp;<span><a href="/new?action=delete&url={{ .URL }}">Delete?</a></span></h2>
            <p>You've selected {{ .Running }}. <a href="/new?action=update&url={{ .URL }}&forge={{ .Forge }}&name={{ .Name }}">Modify?</a></p>
            <p>Latest: <a href="{{ (index .Releases 0).URL }}">{{ (index .Releases 0).Tag }}</a></p>
            <p>
                <details>
                    <summary>Expand release notes</summary>
                    {{- if eq .Forge "github" "gitea" "forgejo" -}}
                    {{- (index .Releases 0).Content -}}
                    {{- else -}}
                    <pre>
                    {{- (index .Releases 0).Content -}}
                    </pre>
                    {{- end -}}
                </details>
            </p>
        </div>
        {{- end -}}
        {{- end -}}

        <!-- Range through projects that _are_ up-to-date -->
        {{- range . -}}
        {{- if eq .Running (index .Releases 0).Tag -}}
        <div class="project">
            <h2><a href="{{ .URL }}">{{ .Name }}</a>&nbsp;&nbsp;&nbsp;<span style="font-size: 12px;"><a href="/new?action=delete&url={{ .URL }}">Delete?</a></span></h2>
            <p>You've selected {{ .Running }}. <a href="/new?action=update&url={{ .URL }}&forge={{ .Forge }}&name={{ .Name }}">Modify?</a></p>
        </div>
        {{- end -}}
        {{- end -}}
    </body>
</html>
